<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>iRDC: The Interactive Reference Data Card</title>
    <style>
        /* Popup styling */
        #equationPopup {
            display: none;
            position: absolute;
            background-color: #fff;
            border: 1px solid black;
            padding: 10px;
            z-index: 1000;
            max-width: 400px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .close-btn {
            position: absolute;
            top: 5px;
            right: 10px;
            cursor: pointer;
            font-size: 14px;
            color: red;
        }
    </style>
    <!-- MathJax for rendering LaTeX -->
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <h1>iRDC: The Interactive Reference Data Card</h1>
    <h3>
        <p><span style="color:red">YOU WILL NOT HAVE THIS VERSION OF THE RDC ON ANY EXAM</span> </p>
    </h3>


    <!-- Container for the SVG -->
    <div id="rdcFront"></div>
    <div id="rdcBack"></div>
    <p> The iRDC was created thanks to MAJ Filip's inspiration with the PH2x1 iPRC (thanks Kevin).
        To suggest additional improvements email: <a href="mailto:dave.pert@westpoint.edu">dave.pert@westpoint.edu</a>
    </p>
    <!-- Popup for displaying LaTeX equations -->
    <div id="equationPopup">
        <span class="close-btn" onclick="closePopup()">Close X</span>
        <div id="latexContent"></div>
    </div>

    <script>
        // Function to load and display LaTeX content
        function loadContent(filename, event, column) {
            fetch(filename)
                .then(response => response.text())
                .then(content => {
                    showPopup(content, event, column);
                })
                .catch(err => console.error('Error loading content:', err));
        }

        // Function to show the popup
        function showPopup(content, event, column) {
            var popup = document.getElementById('equationPopup');
            var latexContainer = document.getElementById('latexContent');

            // Set the content
            latexContainer.innerHTML = content;
            popup.style.display = 'block';
            var offset_y = 30;

            if (column == "left" | column == "middle") {
                offset_x = 0;
                popup.style.top = (event.pageY + offset_y) + 'px';
                popup.style.left = (event.pageX + offset_x) + 'px';
            }
            else {
                // Calculate the center position
                var viewportHeight = window.innerHeight;
                var viewportWidth = window.innerWidth;
                var popupHeight = popup.offsetHeight;
                var popupWidth = popup.offsetWidth;

                popup.style.top = (event.pageY + offset_y) + 'px';
                popup.style.left = (viewportWidth / 2.5 - popupWidth) + 'px';

            }


            // Position the popup


            // Render LaTeX
            MathJax.typesetPromise();
        }

        // Function to close the popup
        function closePopup() {
            document.getElementById('equationPopup').style.display = 'none';
        }
        // Function to initialize rectangle attributes
        function initializeRectangle(area) {
            area.style.fill = 'transparent'; // Original state
            area.style.stroke = 'none';
            area.style.cursor = 'pointer';                  // Optional: change cursor on hover
        }
        // Functions to handle hover effects
        function addHoverEffect(area) {
            area.style.fill = 'rgba(255, 215, 0, 0.25)'; // Gold with transparency
            //area.style.stroke = 'black';
            //area.style.strokeWidth = '2px';
        }

        function removeHoverEffect(area) {
            area.style.fill = 'transparent'; // Original state
            area.style.stroke = 'none';
        }
        function initializeClickableArea(svgElement, areaId, contentUrl, column) {
            var clickableArea = svgElement.getElementById(areaId);
            console.log('Initializing clickable area:', areaId, clickableArea);
            if (clickableArea) {
                initializeRectangle(clickableArea);
                clickableArea.addEventListener('click', function (event) {
                    loadContent(contentUrl, event, column);
                });
                clickableArea.addEventListener('mouseover', function () {
                    addHoverEffect(clickableArea);
                });
                clickableArea.addEventListener('mouseout', function () {
                    removeHoverEffect(clickableArea);
                });
            } else {
                console.warn('Clickable area ' + areaId + ' not found in SVG.');
            }
        }
        // Fetch and embed the SVG
        // Fetch and embed the SVG
// Fetch and embed the SVG
document.getElementById('rdcFront').innerHTML = `
    <svg id="svg8581" width="187mm" height="247mm" viewBox="0 0 187 247">
        <rect id="prc-1" x="10" y="10" width="50" height="50" fill="lightblue"/>
        <rect id="prc-2" x="70" y="10" width="50" height="50" fill="lightgreen"/>
        <text x="20" y="40">Test SVG</text>
    </svg>
`;

setTimeout(() => {
    var svgElement = document.getElementById('svg8581');
    console.log('Test SVG found:', svgElement);
    if (svgElement) {
        initializeClickableArea(svgElement,'prc-1','equations/number-density/eq01_weighted_atomic_mass.html','left');
        initializeClickableArea(svgElement,'prc-2','equations/number-density/eq02_mass_fraction.html','left');
    }
}, 100);
            
               
		
        fetch('img/rdc_back.svg')
                .then(response => response.text())
                .then(svgText => {
                    document.getElementById('rdcBack').innerHTML = svgText;
                    var newSvgElement = document.getElementById('rdcBack').querySelector('svg');
                    if (!newSvgElement) {
                        console.error('New SVG element not found');
                        return;
                    }
                    // Initialize clickable areas for the new SVG if needed
                    // initializeClickableArea(newSvgElement, 'new-area-1', 'some-url.html', 'left');
                });
    </script>
    <h3>
        <p><span style="color:red">YOU WILL NOT HAVE THIS VERSION OF THE RDC ON ANY EXAM</span> </p>
    </h3>
</body>


</html>









